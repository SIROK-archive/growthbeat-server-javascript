var Growthbeat;!function(a){var b=function(){function a(){}return a.get=function(a){if(!document.cookie)return null;var b=document.cookie.split("; ");for(var c in b){var d=b[c].split("=");if(d[0]==a)return decodeURIComponent(d[1])}return null},a.set=function(a,b,c){var d=a+"="+encodeURIComponent(b);d+="; expires="+new Date((new Date).getTime()+c).toUTCString(),document.cookie=d},a}();a.CookieUtils=b}(Growthbeat||(Growthbeat={}));var Growthbeat;!function(a){var b=function(){function a(){}return a}();a.Url=b;var c=function(){function a(){}return a.parseUrl=function(a){var b=a.match(/^(([^:\/?#]+):\/\/)?([^:\/?#]+)(:([0-9]+))?\/?/);return{scheme:b[2]?b[2]:void 0,domain:b[3]?b[3]:void 0,port:b[5]?parseInt(b[5]):void 0}},a}();a.HttpUtils=c}(Growthbeat||(Growthbeat={}));var Growthbeat;!function(a){var b=function(){function a(){}return a.compile=function(a){return function(b){var c=a;for(var d in b)c=c.replace(new RegExp("\\{"+d+"\\}","gm"),b[d]);return c}},a}();a.Template=b}(Growthbeat||(Growthbeat={}));var Growthbeat;!function(a){var b=function(){function b(){}return b.request=function(b,c,d,e,f){var g=document.createElement("div");g.innerHTML=this.template({method:b,url:c,target:"growthbeatXdmView"+Math.round(1e8*Math.random())});var h=g.getElementsByTagName("form")[0];for(var i in d){var j=document.createElement("input");j.type="hidden",j.name=i,j.value=d[i],h.appendChild(j)}var k=g.getElementsByTagName("iframe")[0];window.addEventListener("message",function(b){var c=a.HttpUtils.parseUrl(b.origin).domain,d=a.HttpUtils.parseUrl(a.baseUrl).domain;c==d&&b.source==k.contentWindow&&(e(b.data),f.removeChild(g))},!1),f.appendChild(g),h.submit()},b.template=a.Template.compile('<form method="{method}" action="{url}" target="{target}"></form><iframe id="growthbeatXdmView" name="{target}" style="position: absolute; top: -10000px; height: 0px; width: 0px;"></iframe>'),b}();a.Xdm=b}(Growthbeat||(Growthbeat={}));var Growthbeat;!function(a){var b=function(){function b(){this.opened=!1,this.template=a.Template.compile('<iframe id="growthbeatHeaderView" src="{baseUrl}header/?serviceId={serviceId}&height={height}" allowtransparency="true" style="width: 100%; height: {height}px; border-style: none; position: fixed; top: 0px; padding: 0px; margin: 0px; z-index: 100000;"></iframe><div style="width: 100%; height: {height}px;"></div>')}return b.prototype.show=function(b){var c=this;this.element=document.createElement("div"),this.element.innerHTML=this.template({baseUrl:a.baseUrl,serviceId:a.serviceId,height:a.headerHeight}),this.iframeElement=this.element.getElementsByTagName("iframe")[0],window.addEventListener("message",function(b){console.log(b);var d=a.HttpUtils.parseUrl(b.origin).domain,e=a.HttpUtils.parseUrl(a.baseUrl).domain;if(d==e&&b.source==c.iframeElement.contentWindow){var f=JSON.parse(b.data);switch(f.type){case"open":c.opened=!0;break;case"close":c.opened=!1}c.rerender()}},!1),window.addEventListener("resize",function(){c.rerender()},!1),b.appendChild(this.element)},b.prototype.rerender=function(){this.iframeElement.style.height=(this.opened?window.innerHeight:a.headerHeight)+"px"},b}();a.HeaderView=b}(Growthbeat||(Growthbeat={}));var Growthbeat;!function(a){var b=function(){function b(){a.baseUrl=a.baseUrl||"https://growthbeat.com/",a.headerHeight=a.headerHeight||68,a.rootElementId=a.rootElementId||"growthbeat",a.cookieName=a.cookieName||"growthbeat.sessionId",a.cookieDuration=a.cookieDuration||6048e5}return b.prototype.start=function(){var b=document.createElement("div");return b.id=a.rootElementId,document.body.insertBefore(b,document.body.childNodes[0]),a.CookieUtils.get(a.cookieName)?void(new a.HeaderView).show(b):void a.Xdm.request("GET",a.baseUrl+"xdm/accounts",{serviceId:a.serviceId,url:location.href},function(c){var d=JSON.parse(c);return d&&d.id?void a.Xdm.request("POST",a.baseUrl+"xdm/sessions",{serviceId:a.serviceId,url:location.href},function(b){var c=JSON.parse(b);c.id&&(a.CookieUtils.set(a.cookieName,c.id,a.cookieDuration),location.reload())},b):void(location.href=a.baseUrl+"login?seviceId="+a.serviceId)},b)},b}();a.Core=b}(Growthbeat||(Growthbeat={})),function(){console.log("Load Growthbeat library"),(new Growthbeat.Core).start()}();